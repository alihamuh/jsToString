{"version":3,"file":"javascripttostring.es5.js","sources":["../src/javascripttostring.ts"],"sourcesContent":["import getObjectType from \"get-internal-type\";\r\n\r\nexport interface IJ2SOptions {\r\n  includeFunctionProperties?: boolean;\r\n  includeFunctionPrototype?: boolean;\r\n}\r\n\r\nfunction numberToString(value: number): string {\r\n  if (Number.isNaN(value)) {\r\n    return \"Number.NaN\";\r\n  }\r\n  switch (value) {\r\n    case Number.POSITIVE_INFINITY:\r\n      return \"Number.POSITIVE_INFINITY\";\r\n    case Number.NEGATIVE_INFINITY:\r\n      return \"Number.NEGATIVE_INFINITY\";\r\n    case Number.EPSILON:\r\n      return \"Number.EPSILON\";\r\n    case Number.MAX_SAFE_INTEGER:\r\n      return \"Number.MAX_SAFE_INTEGER\";\r\n    case Number.MIN_SAFE_INTEGER:\r\n      return \"Number.MIN_SAFE_INTEGER\";\r\n    case Number.MAX_VALUE:\r\n      return \"Number.MAX_VALUE\";\r\n    case Number.MIN_VALUE:\r\n      return \"Number.MIN_VALUE\";\r\n    case Math.PI:\r\n      return \"Math.PI\";\r\n    case Math.E:\r\n      return \"Math.E\";\r\n    case Math.LN10:\r\n      return \"Math.LN10\";\r\n    case Math.LN2:\r\n      return \"Math.LN2\";\r\n    case Math.LOG10E:\r\n      return \"Math.LOG10E\";\r\n    case Math.LOG2E:\r\n      return \"Math.LOG2E\";\r\n    case Math.SQRT1_2:\r\n      return \"Math.SQRT1_2\";\r\n    case Math.SQRT2:\r\n      return \"Math.SQRT2\";\r\n    default:\r\n      return String(value);\r\n  }\r\n}\r\n\r\nfunction symbolToString(value: any): string {\r\n  switch (value) {\r\n    case Symbol.asyncIterator:\r\n    case Symbol.hasInstance:\r\n    case Symbol.isConcatSpreadable:\r\n    case Symbol.iterator:\r\n    case Symbol.match:\r\n    case Symbol.prototype:\r\n    case Symbol.replace:\r\n    case Symbol.search:\r\n    case Symbol.species:\r\n    case Symbol.split:\r\n    case Symbol.toPrimitive:\r\n    case Symbol.toStringTag:\r\n    case Symbol.unscopables:\r\n      return value.description;\r\n    default:\r\n      let description = value.description ? `\"${value.description}\"` : \"\";\r\n      return `Symbol(${description})`;\r\n  }\r\n}\r\n\r\nfunction dateToString(value: Date): string {\r\n  if (isNaN(value.getTime())) {\r\n    return `new Date(${value.toString()})`;\r\n  }\r\n  return `new Date(${value.toISOString()})`;\r\n}\r\n\r\nfunction errorToString(value: any): string {\r\n  let message = JSON.stringify(value.message),\r\n    fileName = JSON.stringify(value.fileName),\r\n    lineNumber = JSON.stringify(value.lineNumber);\r\n  return `new Error(${message}, ${fileName}, ${lineNumber})`;\r\n}\r\n\r\nfunction arrayToString(\r\n  value: Array<any>,\r\n  options: IJ2SOptions,\r\n  referenceValues: any[]\r\n): string {\r\n  if (value.length === 0) return \"[]\";\r\n  value[0] = stringifyRef(value[0], options, referenceValues);\r\n  let arrayValues = value.reduce(\r\n    (x1: any, x2: any) => `${x1}, ${stringifyRef(x2, options, referenceValues)}`\r\n  );\r\n  return `[${arrayValues}]`;\r\n}\r\n\r\nfunction setToString(\r\n  value: Set<any>,\r\n  options: IJ2SOptions,\r\n  referenceValues: any[]\r\n): string {\r\n  let setValues: string[] = [];\r\n\r\n  value.forEach((value1: any, value2: any, set: Set<any>) => {\r\n    setValues.push(stringifyRef(value2, options, referenceValues));\r\n  });\r\n\r\n  if (setValues.length === 0) return \"new Set()\";\r\n\r\n  return `new Set([${setValues.join(\", \")}])`;\r\n}\r\n\r\nfunction mapToString(\r\n  value: Map<any, any>,\r\n  options: IJ2SOptions,\r\n  referenceValues: any[]\r\n): string {\r\n  let mapValues: string[] = [];\r\n\r\n  value.forEach((indexValue: any, key: any) => {\r\n    mapValues.push(\r\n      `[${stringifyRef(key, options, referenceValues)}, ${stringifyRef(\r\n        indexValue,\r\n        options,\r\n        referenceValues\r\n      )}]`\r\n    );\r\n  });\r\n\r\n  if (mapValues.length === 0) return \"new Map()\";\r\n\r\n  return `new Map([${mapValues.join(\", \")}])`;\r\n}\r\n\r\nfunction objectToString(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  referenceValues: any[]\r\n): string {\r\n  let objectValues = [];\r\n\r\n  for (let propertyName in value) {\r\n    if (value.hasOwnProperty(propertyName))\r\n      objectValues.push(\r\n        `${propertyName}: ${stringifyRef(\r\n          value[propertyName],\r\n          options,\r\n          referenceValues\r\n        )}`\r\n      );\r\n  }\r\n\r\n  if (objectValues.length === 0) return \"{}\";\r\n\r\n  return `{\\n${objectValues.join(\",\\n\")}\\n}`;\r\n}\r\n\r\nfunction functionToString(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  referenceValues: any[]\r\n): string {\r\n  let functionName = value.name || \"anonymousFunction\";\r\n  let functionObject = \"\";\r\n  let functionPrototype = \"\";\r\n\r\n  if (options.includeFunctionProperties) {\r\n    for (let propertyName in value) {\r\n      if (value.hasOwnProperty(propertyName))\r\n        functionObject += `${functionName}.${propertyName} = ${stringifyRef(\r\n          value[propertyName],\r\n          options,\r\n          referenceValues\r\n        )};\\n`;\r\n    }\r\n  }\r\n\r\n  if (options.includeFunctionPrototype) {\r\n    for (let propertyName in value.prototype) {\r\n      if (value.prototype.hasOwnProperty(propertyName))\r\n        functionObject += `${functionName}.prototype.${propertyName} = ${stringifyRef(\r\n          value.prototype[propertyName],\r\n          options,\r\n          referenceValues\r\n        )};\\n`;\r\n    }\r\n  }\r\n\r\n  if (!functionObject && !functionPrototype) {\r\n    return String(value);\r\n  }\r\n  return `(function(){\\n var ${functionName} = ${String(\r\n    value\r\n  )};\\n ${functionObject}\\n ${functionPrototype}\\n return ${functionName};\\n}())`;\r\n}\r\n\r\n/**\r\n * Converts to string the value, if it wasn't before\r\n * @param value the value, that converts to string\r\n * @param references the references to stringified objects\r\n */\r\nfunction stringify(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  references?: any[]\r\n): string {\r\n  let referenceValues: any[] = references || [value];\r\n  switch (getObjectType(value)) {\r\n    case \"undefined\":\r\n      return \"undefined\";\r\n    case \"null\":\r\n      return \"null\";\r\n    case \"boolean\":\r\n      return String(value);\r\n    case \"regexp\":\r\n      return String(value);\r\n    case \"string\":\r\n      return JSON.stringify(value);\r\n    case \"number\":\r\n      return numberToString(value);\r\n    case \"bigint\":\r\n      return `BigInt(${value})`;\r\n    case \"symbol\":\r\n      return symbolToString(value);\r\n    case \"date\":\r\n      return dateToString(value);\r\n    case \"error\":\r\n      return errorToString(value);\r\n    case \"array\":\r\n      return arrayToString(value, options, referenceValues);\r\n    case \"set\":\r\n      return setToString(value, options, referenceValues);\r\n    case \"map\":\r\n      return mapToString(value, options, referenceValues);\r\n    case \"object\":\r\n      return objectToString(value, options, referenceValues);\r\n    case \"function\":\r\n      return functionToString(value, options, referenceValues);\r\n    default:\r\n      return JSON.stringify(value);\r\n  }\r\n}\r\n\r\n/**\r\n * Stringify the value, if it wasn't before\r\n * @param value the value, that converts to string\r\n * @param references the references to stringified objects\r\n */\r\nfunction stringifyRef(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  references: any[]\r\n): string {\r\n  if (references.indexOf(value) < 0) {\r\n    let referencesLength = references.length;\r\n    references.push(value);\r\n    let refString = stringify(value, options, references);\r\n    references.splice(referencesLength);\r\n    return refString;\r\n  }\r\n  return \"null\";\r\n}\r\n\r\n/**\r\n * Converts JavaScript value to string\r\n * @param value the value of any type\r\n * @param options [optional] The options of conversion\r\n */\r\nfunction javaScriptToString(value: any, options?: IJ2SOptions): string {\r\n  let opt: IJ2SOptions = options || {};\r\n  if (opt.includeFunctionProperties === undefined)\r\n    opt.includeFunctionProperties = true;\r\n  if (opt.includeFunctionPrototype === undefined)\r\n    opt.includeFunctionPrototype = true;\r\n\r\n  return stringify(value, opt);\r\n}\r\n\r\nexport default javaScriptToString;\r\n"],"names":["getObjectType"],"mappings":"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"}